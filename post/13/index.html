<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.69.0-DEV" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>#13 TCP &amp; UDP &middot; 老干妈</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="https://maronghe.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://maronghe.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://maronghe.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://maronghe.github.io/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  
</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://maronghe.github.io/"><h1>老干妈</h1></a>
      <p class="lead">
      An elegant open source and mobile first theme for <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. Originally made for Jekyll.
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://maronghe.github.io/">Home</a> </li>
        
      </ul>
    </nav>

    <p>&copy; 2020. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>#13 TCP &amp; UDP</h1>
  <time datetime=2020-05-29T16:08:53&#43;0800 class="post-date">Fri, May 29, 2020</time>
  <blockquote>
<p>TCP</p>
</blockquote>
<ol>
<li>
<p>TCP三次握手机制，为什么要三次握手？</p>
<p>考点：</p>
<ol>
<li>
<p>为什么要握手？</p>
<p>TCP最重要的特性就是<code>可靠性</code>，自己发出去的数据要等到对方去确认，并回复收到了（ack），TCP是支持双工协议，所以双方都要去维护自己的序列号（seq，不从0开始，随机生成的）。因为要获取序列号（和MSS，滑动窗口），所以要握手。</p>
</li>
<li>
<p>为什么要三次？</p>
<p>因为关闭连接的时候，TCP协议允许连接处于半打开（半关闭）状态。而建立连接不允许连接处于半打开状态，所以Server要把自己的序列号回复过来。</p>
</li>
</ol>
</li>
<li>
<p>HTTP 缓存处理流程？</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gdzbc510l7j31100ggjzo.jpg" alt=""></p>
<p>Request 中 Cache-Control: max-age=30 ，告诉代理服务器，如果有缓存的话，如果超过30秒时，就不要给Client返回，让代理服务器去原服务器去取。</p>
<p>Response 中的 Cache-Control: max-age=30 ，告诉客户端，只能到30秒，否则将视为过期。</p>
</li>
<li>
<p>地址栏输入URL到底发生了什么?</p>
<p>考点：</p>
<ol>
<li>
<p>应用层</p>
<p>DNS域名解析-》代理服务器 -》可能缓存-&gt;网关（Nginx、Apache）-》Origin Server 【如上图所示】</p>
</li>
<li>
<p>请求编码</p>
<p>http://[domain]/[path] -&gt; 转换成 Method ，Path ，Version Protocol，Header等</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gdzbqzrj6ej314c0iqtg4.jpg" alt=""></p>
</li>
<li>
<p>网络分层</p>
<ol>
<li>TCP解决进程到进程之间的通信</li>
<li>IP 解决主机到主机之间的通信</li>
<li>数据链路层 解决 局域网内部的通信</li>
</ol>
</li>
</ol>
</li>
<li>
<p>HTTP长链接有哪些优点？</p>
<p>考点：</p>
<p>1.长链接和短连接的区分？</p>
<p>​	HTTP Header : connect : close / keepalive</p>
<p>2.TCP协议</p>
<ol>
<li>
<p>减少握手建立的消耗</p>
</li>
<li>
<p>降低了慢启动带来了传输效率的影响，支持（1字节-1GB数据大小，<strong>不限于1GB</strong>）</p>
<p>1.TCP天生代流量控制的，但中间的网络带宽等都是有限制的，所以TCP会从慢到快最终到一个合适的传输状态。</p>
</li>
<li>
<p>缺点：TCP字符流协议，长链接传输多个文件的时候，第一个文件没传递完成时不会传第二个，会导致TCP长链接串行传旭。因为TCP会有一个队头阻塞问题，（只要有一个丢包，即使传了对方应用层不会接收。）</p>
</li>
</ol>
</li>
<li>
<p>CLOSE_WAIT产生的原因？（出程序Bug了，可能忘记关闭Socket了，Socket泄露）</p>
</li>
<li>
<p>单播，广播，组播，多播。「TODO」</p>
</li>
<li>
<p>服务器的最大并发连接数是多少？</p>
<p>考点：TCP四元组，并非是65536个端口号的限制。</p>
<ol>
<li>
<p>TCP四元组包括源IP，源端口，目的IP和目的端口。（不仅受制于端口） 2^48 = 2^16 * 2^32 （理论）</p>
</li>
<li>
<p>Linux更多的并发数可以打开（ip local port range 打开）、配置多网卡，虚拟IP（实践）</p>
</li>
<li>
<p>高并发的限制？怎样处理高并发优化？</p>
<p>不要处理一个请求时间过长，否则可能会导致超时。（需要用到事件驱动，因其无阻塞）</p>
</li>
</ol>
</li>
<li>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gdzcswox61j31ci0oi7dr.jpg" alt=""></p>
<p>报文传输：TCP Header 过大 20字节  UDP 8字节</p>
</li>
<li>
<p>TLS/SSL怎么保证安全问题？</p>
<ol>
<li>PKI证书体系：RSA-非对称加密</li>
<li>对称加密算法：速度快，不知道秘钥情况下，不能逆推。</li>
<li>秘钥交换协议：握手阶段协商（DH &amp; ECCDH）</li>
</ol>
</li>
<li>
<p>HTTP 2.0 优点</p>
<p>HTTP 1.1 缺点</p>
<ol>
<li>Header 太长 ：cookie、user-agent 等 每次都发送，占用带宽</li>
<li>不支持多路复用</li>
</ol>
<p>解决：</p>
<ol>
<li>消息推送，访问http//***/index.html 推送css和js。</li>
<li>多路复用：【Chrome下默认6个TCP连接】</li>
<li>HPACK编码：（header压缩编码）
<ol>
<li>动态表</li>
<li>静态表 （常用61个）</li>
<li>静态 Huffman</li>
<li>证书编码</li>
</ol>
</li>
<li>Stream 优先级
<ol>
<li>父子依赖</li>
<li>权重优先级</li>
</ol>
</li>
</ol>
</li>
</ol>
<blockquote>
<p>Other</p>
</blockquote>
<ol>
<li>大厂更考验的是分析能力，即使不会也应该去分析一下。</li>
<li>小厂不希望你有太明显的短板，希望全方位能力。</li>
</ol>

</div>


    </main>

    
      
    
  </body>
</html>
